package com.testcases;

import java.io.File;
import java.io.IOException;

import org.apache.commons.io.FileUtils;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.testng.annotations.AfterSuite;
import org.testng.annotations.BeforeSuite;
import org.testng.annotations.Test;

import com.aventstack.extentreports.ExtentReports;
import com.aventstack.extentreports.ExtentTest;
import com.aventstack.extentreports.reporter.ExtentSparkReporter;


public class AddApplication_test extends Base_Class {
	 ExtentReports extent;
	    ExtentTest test;

	    public static ExtentSparkReporter html;
	    
	    @BeforeSuite
	    public void setUp() {
	        extent = new ExtentReports();
	        html = new ExtentSparkReporter("./reports/extentReports.html");
	        extent.attachReporter(html);
	    }

	    @Test
	    public void addApplication() throws Exception {
	        test = extent.createTest("Test Reports");
	        WebDriver driver = // initialize your WebDriver instance here

	        // Your test steps here
	        
	        // Take screenshot
	        String screenshotPath = "./screenshots/screenshot.png";
	        takeScreenshot(driver, screenshotPath);

	        // Add screenshot to report
	        test.addScreenCaptureFromPath(screenshotPath);
	    }

	    @AfterSuite
	    public void tearDown() {
	        extent.flush();
	    }

	    // Method to take screenshot
	    public void takeScreenshot(WebDriver driver, String filePath) {
	        TakesScreenshot scrShot = ((TakesScreenshot) driver);
	        File SrcFile = scrShot.getScreenshotAs(OutputType.FILE);
	        File DestFile = new File(filePath);
	        try {
	            FileUtils.copyFile(SrcFile, DestFile);
	        } catch (IOException e) {
	            e.printStackTrace();
	        }
	    }
	}